# IR Image Viewer - 使用示例

本文档提供了IR Image Viewer的详细使用示例和常见场景。

## 基本使用

### 示例 1: 启动应用程序

最简单的启动方式：

```bash
python main.py
```

这将打开应用程序的主窗口，您可以通过菜单栏的"文件 → 打开"来加载图像文件。

### 示例 2: 启动时加载文件

如果您已经知道要查看的文件路径，可以在启动时直接加载：

```bash
python main.py data/infrared_image.bin
```

或使用 `-f` 参数：

```bash
python main.py -f data/infrared_image.bin
```

## 配置参数示例

### 示例 3: 查看640×512分辨率的8位图像

1. 启动应用程序并加载文件
2. 在控制面板中设置：
   - 分辨率: 640×512
   - 位深度: 8位
   - 字节序: 小端（默认）
   - 行偏移: 0

### 示例 4: 查看320×256分辨率的16位大端图像

1. 加载文件
2. 配置参数：
   - 分辨率: 320×256
   - 位深度: 16位
   - 字节序: 大端
   - 行偏移: 0

### 示例 5: 处理带有文件头的图像

如果您的二进制文件包含文件头（例如前512字节是元数据），您需要设置文件偏移：

1. 加载文件
2. 设置文件偏移: 512（表示从文件的第512个字节之后开始读取）
3. 配置其他参数（分辨率、位深度等）

**说明**: 文件偏移为512意味着跳过前512字节，从第513字节开始读取图像数据。

### 示例 5.5: 使用自定义分辨率

如果您的图像分辨率不在预设列表中：

**方法1: 使用下拉菜单**
1. 在分辨率下拉框中选择"自定义..."
2. 在弹出的对话框中输入宽度和高度
3. 点击"确定"

**方法2: 使用按钮**
1. 点击"设置自定义分辨率..."按钮
2. 输入宽度（如 1280）和高度（如 720）
3. 点击"确定"

**示例**: 设置1280×720分辨率
- 宽度: 1280 像素
- 高度: 720 像素
- 自定义分辨率会被保存并显示在下拉框中

### 示例 5.6: 实时调整参数

应用程序支持参数实时刷新，无需重新加载文件：

**场景**: 您不确定正确的图像参数

**步骤**:
1. 加载文件
2. 尝试不同的分辨率 → 图像立即刷新
3. 切换8位/16位 → 图像立即刷新
4. 对于16位，尝试不同字节序 → 图像立即刷新
5. 调整文件偏移 → 图像和十六进制视图立即刷新

**优势**:
- ✓ 无需重新加载文件
- ✓ 快速找到正确参数
- ✓ 实时查看效果
- ✓ 十六进制视图同步更新，只显示当前图像数据

## 多帧图像示例

### 示例 6: 查看和播放多帧图像序列

假设您有一个包含100帧640×512图像的文件：

1. 加载文件
2. 配置分辨率为640×512
3. 应用程序会自动计算总帧数（显示在控制面板）
4. 使用控制面板的按钮：
   - 点击 ▶ 按钮前进到下一帧
   - 点击 ◀ 按钮返回到上一帧
   - 点击 ▶▶ 按钮开始自动播放
   - 再次点击暂停播放

### 示例 7: 跳转到特定帧

1. 在控制面板的"当前帧"输入框中输入帧号（例如：50）
2. 按Enter键跳转到该帧

## 十六进制查看示例

### 示例 8: 查看文件的原始十六进制数据

1. 加载文件
2. 切换到"十六进制视图"标签页
3. 您将看到三列显示：
   - 地址偏移量（左侧）
   - 十六进制数据（中间）
   - ASCII字符表示（右侧）

### 示例 9: 搜索特定的字节模式

假设您想查找文件中所有的 `FF 00` 字节序列：

1. 切换到十六进制视图
2. 在搜索框中输入: `FF00`（不需要空格）
3. 点击搜索按钮
4. 所有匹配位置将被高亮显示
5. 视图自动滚动到第一个匹配位置

### 示例 10: 查找文件头标识

许多二进制文件格式有特定的文件头标识。例如，查找 `89 50 4E 47`（PNG文件头）：

1. 在十六进制视图的搜索框输入: `89504E47`
2. 点击搜索
3. 如果找到，说明文件可能包含PNG数据

## 图像查看和分析示例

### 示例 11: 缩放图像

查看图像细节：

1. 在图像视图中，点击工具栏的"放大"按钮（或使用快捷键）
2. 多次点击以进一步放大
3. 使用滚动条浏览放大后的图像
4. 点击"缩小"按钮恢复
5. 点击"适应窗口"按钮自动调整大小

### 示例 12: 查看像素值

分析特定像素的数值：

1. 将鼠标悬停在图像上的任意位置
2. 状态栏将显示：
   - 像素坐标 (X, Y)
   - 像素值（灰度值）

例如：`坐标: (120, 45) 值: 128`

### 示例 13: 比较不同字节序的效果

如果图像显示不正确，可能是字节序设置错误：

1. 加载16位图像
2. 设置字节序为"小端"，观察图像
3. 切换字节序为"大端"，观察变化
4. 选择显示正确的字节序

### 示例 13.5: 16位图像自动增强显示

应用程序会自动对16位图像应用直方图映射，解决全黑显示问题：

**问题**: 16位图像的值范围是0-65535，但实际红外图像通常只使用一小部分，例如：
- 实际值范围: 1000-5000
- 如果直接除以65535显示，所有像素都接近0（黑色）

**解决方案**: 应用程序自动：
1. 检测实际使用的值范围（使用0.1%和99.9%百分位数）
2. 将这个范围拉伸到0-255
3. 例如：1000映射到0（黑），5000映射到255（白）

**效果**: 
- 图像清晰可见，对比度良好
- 自动忽略极端异常值
- 无需手动调整

### 示例 13.6: 使用有符号16位数据

某些图像数据包含负值，需要使用有符号数据类型：

**场景**: 您有一个包含温度差异数据的16位图像，值范围从-2000到2000

**步骤**:
1. 加载文件
2. 设置分辨率（如640×512）
3. 设置位深度为：16位
4. 设置数据类型为：**有符号 (-32768-32767)**
5. 图像将正确显示，包括负值

**说明**:
- **无符号（默认）**: 适用于大多数红外图像，值范围0-65535
- **有符号**: 适用于包含负值的数据，值范围-32768-32767
- 直方图映射自动处理负值，正确显示图像
- 8位图像总是无符号的（0-255）

## 故障排除示例

### 示例 14: 图像显示为噪声

如果图像看起来像随机噪声，可能的原因：

1. **分辨率不正确**: 
   - 尝试预设分辨率选项
   - 或使用自定义分辨率功能输入正确的宽度和高度
2. **位深度错误**: 切换8位/16位设置
3. **字节序错误**: 对于16位图像，尝试切换字节序
4. **文件偏移错误**: 
   - 如果文件有头部，设置正确的文件偏移量
   - 例如：512字节的文件头需要设置偏移为512

### 示例 15: 文件加载失败

如果文件无法加载：

1. 检查文件是否存在
2. 检查文件权限（是否可读）
3. 检查文件是否为空
4. 查看错误消息了解具体原因

### 示例 16: 图像只显示部分内容

如果只能看到图像的一部分：

1. 检查文件大小是否足够
2. 验证分辨率设置是否正确
3. 计算所需字节数：
   - 8位: 宽度 × 高度 × 1 字节
   - 16位: 宽度 × 高度 × 2 字节
4. 确保文件大小 ≥ 所需字节数

## 高级使用场景

### 示例 17: 批量查看多个文件

虽然应用程序一次只能打开一个文件，但您可以：

1. 打开第一个文件
2. 配置好参数
3. 使用"文件 → 打开"加载下一个文件
4. 参数设置会保持，方便快速切换

### 示例 18: 导出特定帧（未来功能）

注意：当前版本不支持导出功能，但您可以：

1. 使用截图工具捕获图像视图
2. 或在十六进制视图中复制特定字节范围

### 示例 19: 分析温度数据

如果您的红外图像包含温度数据（通常是16位）：

1. 设置为16位模式
2. 正确配置字节序
3. 鼠标悬停查看像素值
4. 像素值通常对应温度（需要根据您的设备校准）

### 示例 20: 处理非标准分辨率

应用程序现在支持自定义分辨率！

**场景**: 您有一个384×288的红外图像

**步骤**:
1. 加载文件
2. 点击"设置自定义分辨率..."按钮
3. 输入宽度: 384
4. 输入高度: 288
5. 点击"确定"
6. 图像将使用自定义分辨率显示

**提示**: 
- 自定义分辨率会被保存，下次可以直接从下拉框选择
- 支持1-10000像素范围内的任意分辨率

## 性能优化提示

### 大文件处理

- 超过100MB的文件会自动使用内存映射
- 这样可以快速加载而不占用大量内存
- 十六进制视图使用虚拟滚动，只渲染可见部分

### 多帧播放

- 播放速度可以调整
- 最近访问的帧会被缓存
- 对于大量帧，建议降低播放速度

## 命令行使用技巧

### 在脚本中使用

创建批处理脚本快速打开常用文件：

**Windows (view_image.bat):**
```batch
@echo off
python main.py "C:\data\infrared\image_%1.bin"
```

使用: `view_image 001`

**Linux/Mac (view_image.sh):**
```bash
#!/bin/bash
python main.py "/data/infrared/image_$1.bin"
```

使用: `./view_image.sh 001`

## 总结

IR Image Viewer 提供了灵活的配置选项来处理各种二进制图像格式。关键是：

1. 正确设置分辨率
2. 选择正确的位深度
3. 对于16位图像，尝试两种字节序
4. 如有文件头，设置适当的行偏移

如有问题，请参考README.md或提交Issue。
